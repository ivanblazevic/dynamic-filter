{"version":3,"sources":["dynamicFilter.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length","module","Object","defineProperty","value","AXArray","arguments","last","removeLastItem","splice","Array","default","ExtendedArray_1","Filter","ref","callback","canAddValue","values","push","isText","option","setApplyEnabled","optionType","type","checkOptionType","Filter_1","Filters","options","config","getID","id","saveState","filterState","map","m","localStorage","setItem","JSON","stringify","force","autoApply","getResult","applyButton","setApplyDisabled","isApplyEnabled","add","lastFilter","getOptionByField","field","result","filter","loadState","state","parse","getItem","self","forEach","lastAddedFilter","onSelect","v","addValue","removeLast","isFilterSelected","some","isValueSelected","errorCallback","window","DynamicFilter","apply"],"mappings":"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","file":"dynamicFilter.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n\n},{}],2:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nclass AXArray extends Array {\n    constructor() {\n        super(...arguments);\n        this.last = () => {\n            return this[this.length - 1];\n        };\n        this.removeLastItem = () => {\n            this.splice(-1, 1);\n        };\n    }\n}\nexports.default = AXArray;\n\n},{}],3:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst ExtendedArray_1 = require(\"./ExtendedArray\");\nclass Filter {\n    constructor(ref) {\n        this.callback = ref.callback;\n        this.ref = ref;\n    }\n    addValue() {\n        if (!this.canAddValue())\n            return;\n        this.values.push(\"\"); // add empty value so array can be iterated in html\n    }\n    /**\n    * Cannot add new value if previous value does not exist\n    * or if type is text, text can only have one value\n    */\n    canAddValue() {\n        return this.values && this.values.last() && !this.isText();\n    }\n    onSelect(option) {\n        this.values = new ExtendedArray_1.default();\n        this.option = option;\n        this.values.push(\"\");\n        this.ref.setApplyEnabled();\n    }\n    checkOptionType(optionType) {\n        if (!this.option)\n            return false;\n        return this.option.type == optionType;\n    }\n    isAutocomplete() {\n        return this.checkOptionType(\"AUTOCOMPLETE\" /* AUTOCOMPLETE */);\n    }\n    isOptions() {\n        return this.checkOptionType(\"OPTIONS\" /* OPTIONS */);\n    }\n    isText() {\n        return this.checkOptionType(\"TEXT\" /* TEXT */);\n    }\n}\nexports.default = Filter;\n\n},{\"./ExtendedArray\":2}],4:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst ExtendedArray_1 = require(\"./ExtendedArray\");\nconst Filter_1 = require(\"./Filter\");\nclass Filters extends ExtendedArray_1.default {\n    constructor(options, config) {\n        super();\n        this.options = options;\n        this.config = config;\n        this.getID = () => {\n            return this.config.id || \"dynamicFilter\";\n        };\n        this.saveState = () => {\n            // only neccessary stuff will be saved to local storage\n            let filterState = this.map(function (m) {\n                return {\n                    option: m.option,\n                    values: m.values\n                };\n            });\n            localStorage.setItem(this.getID(), JSON.stringify(filterState));\n        };\n        /**\n         * @force - boolean: used to override config.autoApply\n         */\n        this.callback = (force) => {\n            if (!this.config)\n                return;\n            if (this.saveState)\n                this.saveState();\n            if (force || this.config.autoApply)\n                this.config.callback(this.getResult());\n        };\n        this.setApplyEnabled = () => {\n            this.applyButton = true;\n        };\n        this.setApplyDisabled = () => {\n            this.applyButton = false;\n        };\n        this.isApplyEnabled = () => {\n            return this.applyButton;\n        };\n        this.add = () => {\n            // Prevent adding filter if no previous selected\n            let lastFilter = this.last();\n            if (lastFilter && !lastFilter.option)\n                return;\n            this.setApplyDisabled();\n            this.push(new Filter_1.default(this));\n        };\n        this.getOptionByField = (options, field) => {\n            let result = options.filter(function (o) {\n                return o.field == field;\n            });\n            if (result.length == 0)\n                throw (\"Cached option field value \" + field + \" not found in options array!\");\n            return result[0];\n        };\n        this.loadState = () => {\n            var state = JSON.parse(localStorage.getItem(this.getID()));\n            if (!state)\n                return;\n            var self = this;\n            state.forEach(function (s) {\n                if (!s.values)\n                    return;\n                self.add();\n                let lastAddedFilter = self.last();\n                let option = self.getOptionByField(self.options, s.option.field);\n                lastAddedFilter.onSelect(option);\n                // add values\n                s.values.forEach(function (v) {\n                    lastAddedFilter.addValue();\n                    lastAddedFilter.values[lastAddedFilter.values.length - 1] = v;\n                });\n            });\n        };\n        this.removeLast = () => {\n            this.removeLastItem();\n            this.callback();\n            if (this.length == 0)\n                this.applyButton = false;\n        };\n        this.isFilterSelected = (option) => {\n            return this.some(function (f) {\n                return f.option && f.option.field == option.field;\n            });\n        };\n        this.isValueSelected = (value) => {\n            return this.some(function (f) {\n                return f.values && f.values.some && f.values.some(function (v) {\n                    return v == value;\n                });\n            });\n        };\n        this.getResult = () => {\n            let self = this;\n            return this.map(function (m) {\n                var o = {};\n                if (!m.option) {\n                    if (self.config.errorCallback)\n                        self.config.errorCallback(\"Select option before getting result\");\n                    throw (\"Select option before getting result\");\n                }\n                o[m.option.field] = m.values;\n                return o;\n            });\n        };\n        if (!options)\n            throw (\"Options not passed to DynamicFilter constructor!\");\n        if (!config)\n            throw (\"Callback not passed to DynamicFilter constructor!\");\n        // TODO: should be handled properly; constructor has been called when this.splice is executed?\n        //if (!config || !options) return;\n        if (config.autoApply == null)\n            config.autoApply = true;\n        this.config = config;\n        if (this.config.saveState) {\n            this.loadState();\n            this.config.callback(this.getResult());\n        }\n    }\n}\nexports.Filters = Filters;\nwindow.DynamicFilter = Filters;\n\n},{\"./ExtendedArray\":2,\"./Filter\":3}],5:[function(require,module,exports){\narguments[4][1][0].apply(exports,arguments)\n},{\"dup\":1}]},{},[1,2,3,4,5]);\n"]}